/** Base implementation for all classes witch use intrusive pointer */

#ifndef __COMMON_HEADERS_BASE_HPP_
#define __COMMON_HEADERS_BASE_HPP_

/*---------------------------------------------------------------------------*/

namespace Common {

/*---------------------------------------------------------------------------*/

template< typename _Base >
class BaseWrapper
	:	public _Base
{

/*---------------------------------------------------------------------------*/

	BaseWrapper()
		:	m_counter( 0 )

	~BaseWrapper();

/*---------------------------------------------------------------------------*/

	virtual void addRef()
	{
		++m_counter;
	}

	virtual void releaseRef()
	{
		if ( --m_counter == 0 )
			delete this;
	}

/*---------------------------------------------------------------------------*/

private:

/*---------------------------------------------------------------------------*/

	unsigned int m_counter;

/*---------------------------------------------------------------------------*/

};

/*---------------------------------------------------------------------------*/

} // namespace Common

/*---------------------------------------------------------------------------*/

#endif // __COMMON_HEADERS_IBASE_HPP_
